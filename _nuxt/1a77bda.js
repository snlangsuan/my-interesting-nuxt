(window.webpackJsonp=window.webpackJsonp||[]).push([[13,6],{1059:function(e,t,n){"use strict";n.r(t);n(94),n(12),n(9),n(10),n(17),n(11),n(18),n(47),n(32),n(62),n(48),n(63),n(66),n(49);var o=n(3),r=n(27),l=n(51),c=n(44),d=n(31),f=n(37),h=n(36),v=(n(91),n(28),n(223),n(176),n(26),n(80),n(72),n(6),n(138),n(833)),m=n(896),_=n.n(m),y=n(821);function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function D(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?D(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):D(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(c.a)(this,n)}}var O=Object(f.a)((function e(t){return Object(h.a)(this,e),v.f.l1l2(t)}));O.className="L2",v.i.registerClass(O);var S=function(e){Object(l.a)(n,e);var t=C(n);function n(){return Object(h.a)(this,n),t.call(this,{})}return Object(f.a)(n,null,[{key:"className",get:function(){return"Lambda"}}]),n}(v.c.Layer);v.i.registerClass(S);var T={name:"AdDetectionPage",layout:"ml",data:function(){return{title:"Offline-advertising Detection",loading:{show:!0,message:"Getting model version..."},databases:[],uploadDatabaseDialog:!1,createDatabaseValid:!0,createDatabase:{label:"",img:""},initializing:!0,databaseUploading:!1,testUploading:!1,isPreviewUploaded:!1,embeddingModel:null,screenWidth:100,canvasWidth:100,canvasHeight:100,testImg:null,bboxes:[],knn:null,hasProblem:!1,classificationThresholdDialog:!1,tempClassificationThreshold:.7,minimumClassificationThreshold:.7,localizationThresholdDialog:!1,tempLocalizationThreshold:.6,minimumLocalizationThreshold:.6,confidenceValid:!0,hasChangVersion:!1}},head:function(){return{title:this.title}},mounted:function(){this.initialize()},methods:{initialize:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.initializing=!0,e.loading.message="Getting model version...",e.loading.show=!0,t.next=6,e.getModelVersion();case 6:if(e.loading.message="Loading model...",!localStorage.getItem("detection-offline-ad")){t.next=15;break}return t.next=11,v.d("indexeddb://detection-offline-ad");case 11:n=t.sent,e.embeddingModel=n,t.next=22;break;case 15:return t.next=17,v.d("https://storage.googleapis.com/demo-ml-model/detection-offline-ad/model.json");case 17:return o=t.sent,e.embeddingModel=o,t.next=21,o.save("indexeddb://detection-offline-ad");case 21:localStorage.setItem("detection-offline-ad",!0);case 22:e.loading.message="Loading database...",e.loadDatabaseLocalStorage(),e.hasChangVersion&&(e.loading.message="Re-generate database...",e.reversionDatabase()),null!==(r=localStorage.getItem("offline-ad-classification-threshold"))&&(e.minimumClassificationThreshold=Number(r)),null!==(l=localStorage.getItem("offline-ad-localization-threshold"))&&(e.minimumLocalizationThreshold=Number(l)),t.next=34;break;case 31:t.prev=31,t.t0=t.catch(0),console.error(t.t0);case 34:return t.prev=34,e.initializing=!1,e.loading.show=!1,t.finish(34);case 38:case"end":return t.stop()}}),t,null,[[0,31,34,38]])})))()},onResize:function(){var e=document.querySelector("#workspace");if(this.screenWidth=window.innerWidth,e){var t=e.offsetWidth-32,n=this.screenWidth>560?.6:1;this.canvasWidth=Math.round(t*n),this.canvasHeight=this.canvasWidth}},resizeCanvas:function(){var e=document.querySelector("#workspace");e&&console.log(e.offsetWidth)},handleAddDatabase:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,image,o,r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$refs.database_form.validate()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,n=JSON.parse(JSON.stringify(e.createDatabase)),e.uploadDatabaseDialog=!1,e.databaseUploading=!0,e.loading.message="Adding Image to database...",e.loading.show=!0,t.next=10,e.base64ToImage(e.createDatabase.img);case 10:image=t.sent,o=e.getEmbedded(image),r=Date.now(),l=_()(r).toHex(),e.databases.push({id:r,img:n.img,label:n.label,embedded:o,color:l}),e.trainingModel(e.databases),e.updateDatabaseLocalStorage(e.databases),t.next=21;break;case 19:t.prev=19,t.t0=t.catch(2);case 21:return t.prev=21,e.databaseUploading=!1,e.createDatabase.img=null,e.createDatabase.label="",e.loading.show=!1,t.finish(21);case 27:case"end":return t.stop()}}),t,null,[[2,19,21,27]])})))()},handleOnRemoveDatabase:function(e){if(e)try{var t=this.databases.findIndex((function(t){return t.id===e}));t>-1&&(this.databases.splice(t,1),this.trainingModel(this.databases),this.updateDatabaseLocalStorage(this.databases))}catch(e){console.error("remove database error",e)}},handleOnUploadPreview:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t.testUploading=!0,t.loading.message="Finding Offline advertise...",t.loading.show=!0,t.isPreviewUploaded=!0,t.testImg=e,n.next=8,t.getOfflineAd(e.split(",")[1]);case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),console.error(n.t0);case 13:return n.prev=13,t.testUploading=!1,t.loading.show=!1,n.finish(13);case 17:case"end":return n.stop()}}),n,null,[[0,10,13,17]])})))()},getOfflineAd:function(image){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var body,n,o,r,i,l,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return body={image:image,threshold:e.minimumLocalizationThreshold},t.next=3,e.$axios.$post("https://ad-detection-service-bxltsvmqda-as.a.run.app/ads/detection",body);case 3:return n=t.sent,t.next=6,e.$refs.image_canvas.getImageData(n.objects);case 6:for(i in o=t.sent,r=[],o)l=o[i],c=e.getEmbedded(l),(d=e.querySimilarity(c))&&r.push(k(k({},n.objects[i]),{},{object:d.label,score:d.score,color:d.color}));e.bboxes=r;case 10:case"end":return t.stop()}}),t)})))()},trainingModel:function(e){var t=e.map((function(e){return e.embedded})),n=e.map((function(e){return e.id}));this.knn={embedded:t,labels:n}},base64ToImage:function(e){return new Promise((function(t,n){var image=new Image;image.onload=function(){t(image)},image.src=e}))},getEmbedded:function(img){var e=v.b.fromPixels(img).resizeNearestNeighbor([224,224]).toFloat().div(v.g(255)).expandDims();return this.embeddingModel.predict(e).arraySync()[0]},querySimilarity:function(e){var t=this.knn.embedded,n=this.knn.labels,o=-1,r=0;for(var i in t){var l=t[i],c=Object(y.cosineSimilarity)(l,e);console.log(c,this.queryDatabase(n[i])),c>r&&(o=n[i],r=c)}if(-1===o||r<this.minimumClassificationThreshold)return null;var d=this.queryDatabase(o);return{id:o,label:null==d?void 0:d.label,score:r,color:null==d?void 0:d.color}},queryDatabase:function(e){return this.databases.find((function(t){return t.id===e}))},handleOnDeletePreview:function(){this.testImg=null,this.bboxes=[],this.isPreviewUploaded=!1},handleOnDeleteDatabase:function(){try{this.databases=[],localStorage.removeItem("offline-ad-databases")}catch(e){console.error("remove database",e)}},handleOnUploadDatabase:function(){var e=this;this.uploadDatabaseDialog=!0,this.$nextTick((function(){e.$refs.database_form.reset(),e.$refs.database_form.resetValidation()}))},chkLabelDuplicate:function(label){return!this.databases.find((function(e){return e.label===label}))||"Label already exists."},handleOnReloadPage:function(){window.location.reload()},getModelVersion:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$get("https://storage.googleapis.com/demo-ml-model/detection-offline-ad/version.json");case 3:n=t.sent,o=localStorage.getItem("detection-offline-ad-version"),e.hasChangVersion=!1,o!==n.version&&(localStorage.removeItem("detection-offline-ad"),window.indexedDB.deleteDatabase("detection-offline-ad"),localStorage.setItem("detection-offline-ad-version",n.version),e.hasChangVersion=!0),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e.hasProblem=!0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},loadDatabaseLocalStorage:function(){try{var e=localStorage.getItem("offline-ad-databases");e&&(this.databases=JSON.parse(e),this.trainingModel(this.databases))}catch(e){console.error("load database error",e)}},updateDatabaseLocalStorage:function(e){try{localStorage.setItem("offline-ad-databases",JSON.stringify(e))}catch(e){console.error("update database error",e)}},handleOnLocalizationThreshold:function(){this.tempLocalizationThreshold=this.minimumLocalizationThreshold,this.localizationThresholdDialog=!0},handleOnClassificationThreshold:function(){this.tempClassificationThreshold=this.minimumClassificationThreshold,this.classificationThresholdDialog=!0},handelOnSaveClassificationThreshold:function(){try{this.minimumClassificationThreshold=this.tempClassificationThreshold,this.classificationThresholdDialog=!1,localStorage.setItem("offline-ad-classification-threshold",this.minimumClassificationThreshold)}catch(e){console.error("update minimum confidence error",e)}},handleOnClassificationDecrement:function(){this.tempClassificationThreshold-=.1},handleOnClassificationIncrement:function(){this.tempClassificationThreshold+=.1},handelOnSaveLocalizationThreshold:function(){try{this.minimumLocalizationThreshold=this.tempLocalizationThreshold,this.localizationThresholdDialog=!1,console.log(this.minimumLocalizationThreshold),localStorage.setItem("offline-ad-localization-threshold",this.minimumLocalizationThreshold)}catch(e){console.error("update minimum confidence error",e)}},handleOnLocalizationDecrement:function(){this.tempLocalizationThreshold-=.1},handleOnLocalizationIncrement:function(){this.tempLocalizationThreshold+=.1},reversionDatabase:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r,image;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=x(e.databases),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=11;break}return r=o.value,t.next=7,e.base64ToImage(r.img);case 7:image=t.sent,r.embedded=e.getEmbedded(image);case 9:t.next=3;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),n.e(t.t0);case 16:return t.prev=16,n.f(),t.finish(16);case 19:console.log("update reversion",e.databases),e.trainingModel(e.databases),e.updateDatabaseLocalStorage(e.databases);case 22:case"end":return t.stop()}}),t,null,[[1,13,16,19]])})))()},handleOnDetectAgain:function(){this.handleOnUploadPreview(this.testImg)}}},I=(n(997),n(67)),z=n(81),j=n.n(z),V=n(297),L=n(823),A=n(632),R=n(1051),M=n(1053),P=n(1054),$=n(199),U=n(171),B=n(200),F=n(133),E=n(95),W=n(1055),N=n(203),H=n(824),J=n(1056),K=n(464),Y=n(1064),G=n(1057),X=n(1018),Q=n.n(X),Z=n(217),component=Object(I.a)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"ad-detection-page fill-height"},[n("div",{staticClass:"ad-detection__container"},[n("v-card",[n("v-card-title",{staticClass:"py-2"},[n("div",[e._v("Artwork")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),o),[n("v-icon",[e._v("mdi-dots-vertical")])],1)]}}])},[e._v(" "),n("v-list",[n("v-list-item",{on:{click:e.handleOnLocalizationThreshold}},[n("v-list-item-title",[e._v("Localization threshold")])],1),e._v(" "),n("v-list-item",{on:{click:e.handleOnClassificationThreshold}},[n("v-list-item-title",[e._v("Similarity threshold")])],1),e._v(" "),n("v-list-item",{attrs:{disabled:e.databases.length<1},on:{click:e.handleOnDeleteDatabase}},[n("v-list-item-title",{staticClass:"error--text"},[e._v("Delete Database")])],1)],1)],1)],1),e._v(" "),n("v-divider"),e._v(" "),n("v-card-text",[e.databases.length>0?n("div",[e._v(e._s(e.databases.length)+" Annotation")]):n("div",[e._v("Add Annotation:")]),e._v(" "),n("div",{staticClass:"ad-detection-database"},[n("div",{staticClass:"ad-detection-upload-btn",on:{click:e.handleOnUploadDatabase}},[n("v-icon",{attrs:{size:"18"}},[e._v("mdi-tray-arrow-up")]),e._v(" "),n("div",{staticClass:"ad-detection-upload-btn__text"},[e._v("Upload")])],1),e._v(" "),n("div",{staticClass:"ad-detection-database-list"},[e._l(e.databases,(function(t){return[n("div",{key:t.id,staticClass:"ad-detection-database-item"},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(o){var r=o.on,l=o.attrs;return[n("div",e._g(e._b({},"div",l,!1),r),[n("v-img",{attrs:{src:t.img,width:"100%",contain:""}}),e._v(" "),n("div",{staticClass:"ad-detection-database-item__remove"},[n("v-icon",{attrs:{color:"white"},on:{click:function(n){return e.handleOnRemoveDatabase(t.id)}}},[e._v("mdi-close-circle")])],1)],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.label))])])],1)]}))],2)])])],1),e._v(" "),n("v-card",{staticClass:"mt-4",attrs:{id:"workspace"}},[n("v-card-title",{staticClass:"py-2"},[n("div",[e._v("Preview")]),e._v(" "),n("v-spacer"),e._v(" "),e.testImg?n("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),o),[n("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750)},[e._v(" "),n("v-list",[n("v-list-item",{attrs:{disabled:!e.testImg},on:{click:e.handleOnDetectAgain}},[n("v-list-item-title",[e._v("Detect Again")])],1),e._v(" "),n("v-list-item",{attrs:{disabled:!e.testImg},on:{click:e.handleOnDeletePreview}},[n("v-list-item-title",{staticClass:"error--text"},[e._v("Delete Preview")])],1)],1)],1):e._e()],1),e._v(" "),n("v-divider"),e._v(" "),e.databases.length>0&&!e.isPreviewUploaded?n("v-card-text",[n("upload-image-field",{ref:"upload_test",staticStyle:{width:"100%"},attrs:{"add-text":"Click to upload",accept:"image/jpeg"},on:{change:e.handleOnUploadPreview},model:{value:e.testImg,callback:function(t){e.testImg=t},expression:"testImg"}})],1):e.isPreviewUploaded?n("v-card-text",[n("div",{staticClass:"ad-detection-workspace",style:{display:e.screenWidth>560?"flex":"block"}},[n("div",{staticClass:"ad-detection-workspace__canvas"},[n("bounding-box-canvas",{ref:"image_canvas",attrs:{src:e.testImg,bboxes:e.bboxes,width:e.canvasWidth,height:e.canvasHeight}})],1),e._v(" "),n("div",{staticClass:"ad-detection-workspace__output"},[e.testUploading?e._e():n("div",{class:["ad-detection-results",e.screenWidth>560?"pl-4":"pt-4"],style:{maxHeight:e.canvasHeight+"px"}},[n("div",{staticClass:"ad-detection-results__title"},[e._v("Predictions")]),e._v(" "),n("div",{staticClass:"ad-detection-results__subtitle",staticStyle:{"margin-bottom":"8px"}},[e._v(e._s(e.bboxes.length)+" objects")]),e._v(" "),e._l(e.bboxes,(function(t,i){return[n("div",{key:"res-"+i,staticClass:"ad-detection-results__item"},[n("div",{staticClass:"ad-detection-results__color-box",style:{backgroundColor:t.color}}),e._v(" "),n("div",{staticClass:"ad-detection-results__label"},[e._v("\n                    "+e._s(t.object)+"\n                  ")]),e._v(" "),n("div",{staticClass:"ad-detection-results__percent"},[n("v-progress-linear",{attrs:{value:100*t.score,height:"18"}},[n("div",{staticStyle:{width:"100%"}},[n("div",{staticClass:"white--text text-right",style:{width:Math.ceil(100*t.score)+"%",paddingRight:"8px"}},[e._v(e._s(Math.ceil(100*t.score))+"%")])])])],1)])]}))],2)])])]):n("v-card-text",[e._v("\n        You must add artwork on top panel before you can preview it here\n      ")])],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"480",persistent:""},model:{value:e.uploadDatabaseDialog,callback:function(t){e.uploadDatabaseDialog=t},expression:"uploadDatabaseDialog"}},[n("v-card",[n("v-card-title",[e._v("Add new artwork")]),e._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("v-form",{ref:"database_form",on:{submit:function(e){e.preventDefault()}},model:{value:e.createDatabaseValid,callback:function(t){e.createDatabaseValid=t},expression:"createDatabaseValid"}},[n("v-text-field",{attrs:{label:"Label",rules:[function(e){return!!e||"Enter label name"},e.chkLabelDuplicate],dense:"",outlined:""},model:{value:e.createDatabase.label,callback:function(t){e.$set(e.createDatabase,"label",t)},expression:"createDatabase.label"}}),e._v(" "),n("upload-image-field",{ref:"upload_database",staticStyle:{width:"100%"},attrs:{rules:[function(e){return!!e||"Enter image"}],"add-text":"Click to upload",accept:"image/jpeg"},model:{value:e.createDatabase.img,callback:function(t){e.$set(e.createDatabase,"img",t)},expression:"createDatabase.img"}})],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.uploadDatabaseDialog=!1}}},[e._v("cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handleAddDatabase}},[e._v("add")])],1)],1)],1),e._v(" "),n("v-overlay",{model:{value:e.loading.show,callback:function(t){e.$set(e.loading,"show",t)},expression:"loading.show"}},[n("div",{staticClass:"ad-detection__overlay-box"},[e._v(e._s(e.loading.message))])]),e._v(" "),n("v-dialog",{attrs:{"max-width":"640",persistent:""},model:{value:e.hasProblem,callback:function(t){e.hasProblem=t},expression:"hasProblem"}},[n("v-card",[n("v-card-text",{staticClass:"py-4 text-center"},[n("div",{staticClass:"py-3"},[n("v-icon",{attrs:{color:"primary",size:"48"}},[e._v("mdi-connection")])],1),e._v(" "),n("div",{staticClass:"text-h6"},[e._v("Something went wrong...")]),e._v(" "),n("div",{staticClass:"text-body-2 pb-6"},[e._v("We are working on fixing the problem Please try again.")]),e._v(" "),n("v-btn",{attrs:{color:"primary",plain:""},on:{click:e.handleOnReloadPage}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-refresh")]),e._v("\n          Refresh Page\n        ")],1)],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"320",persistent:""},model:{value:e.classificationThresholdDialog,callback:function(t){e.classificationThresholdDialog=t},expression:"classificationThresholdDialog"}},[n("v-card",[n("v-card-title",[e._v("Classification Threshold")]),e._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("div",{staticClass:"text-h4 font-weight-light"},[e._v("\n          "+e._s(e.tempClassificationThreshold)+"\n        ")]),e._v(" "),n("v-slider",{attrs:{max:"1",min:"0",step:"0.1",color:"primary","track-color":"grey","always-dirty":"","hide-details":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnClassificationDecrement}},[e._v("\n              mdi-minus\n            ")])]},proxy:!0},{key:"append",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnClassificationIncrement}},[e._v("\n              mdi-plus\n            ")])]},proxy:!0}]),model:{value:e.tempClassificationThreshold,callback:function(t){e.tempClassificationThreshold=t},expression:"tempClassificationThreshold"}})],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.classificationThresholdDialog=!1}}},[e._v("cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handelOnSaveClassificationThreshold}},[e._v("Save")])],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"320",persistent:""},model:{value:e.localizationThresholdDialog,callback:function(t){e.localizationThresholdDialog=t},expression:"localizationThresholdDialog"}},[n("v-card",[n("v-card-title",[e._v("Localization Threshold")]),e._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("div",{staticClass:"text-h4 font-weight-light"},[e._v("\n          "+e._s(e.tempLocalizationThreshold)+"\n        ")]),e._v(" "),n("v-slider",{attrs:{max:"1",min:"0",step:"0.1",color:"primary","track-color":"grey","always-dirty":"","hide-details":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnLocalizationDecrement}},[e._v("\n              mdi-minus\n            ")])]},proxy:!0},{key:"append",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnLocalizationIncrement}},[e._v("\n              mdi-plus\n            ")])]},proxy:!0}]),model:{value:e.tempLocalizationThreshold,callback:function(t){e.tempLocalizationThreshold=t},expression:"tempLocalizationThreshold"}})],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.localizationThresholdDialog=!1}}},[e._v("cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handelOnSaveLocalizationThreshold}},[e._v("Save")])],1)],1)],1)],1)}),[],!1,null,"4bedfcdf",null);t.default=component.exports;j()(component,{UploadImageField:n(834).default,BoundingBoxCanvas:n(835).default}),j()(component,{VBtn:V.a,VCard:L.a,VCardActions:A.a,VCardText:A.b,VCardTitle:A.c,VDialog:R.a,VDivider:M.a,VForm:P.a,VIcon:$.a,VImg:U.a,VList:B.a,VListItem:F.a,VListItemTitle:E.b,VMenu:W.a,VOverlay:N.a,VProgressLinear:H.a,VSlider:J.a,VSpacer:K.a,VTextField:Y.a,VTooltip:G.a}),Q()(component,{Resize:Z.a})},591:function(e,t,n){var content=n(704);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(25).default)("6b30970d",content,!0,{sourceMap:!1})},592:function(e,t,n){var content=n(706);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(25).default)("2a1d359e",content,!0,{sourceMap:!1})},703:function(e,t,n){"use strict";n(591)},704:function(e,t,n){var o=n(24)(!1);o.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([e.i,".upload-field[data-v-17bc6f95]{position:relative}.upload-field__content[data-v-17bc6f95]{border:thin dashed #1967d2!important;border-radius:4px;padding:8px;display:flex;align-items:center;justify-content:center;position:relative;margin-bottom:4px;width:100%;height:240px;background-color:#e8f0fe;overflow:hidden;z-index:99;color:#1967d2!important}.upload-field__content *[data-v-17bc6f95]{pointer-events:none}.upload-field__content>input[data-v-17bc6f95]{display:none}.upload-field__drop-zone[data-v-17bc6f95]{text-align:center}.upload-field--error[data-v-17bc6f95]{border:2px solid #ff5252!important}.upload-field__disabled[data-v-17bc6f95]{position:absolute;top:0;bottom:0;left:0;right:0}.upload-field__details[data-v-17bc6f95]{margin-bottom:8px;padding:0 12px;display:flex;flex:1 0 auto;max-width:100%;min-height:14px;overflow:hidden}.upload-field__details--hide[data-v-17bc6f95]{display:none!important}.upload-field--readonly[data-v-17bc6f95]{cursor:auto}.upload-field:hover .upload-field__image--remove[data-v-17bc6f95]{display:flex}.upload-field:hover .upload-field__image--remove>*[data-v-17bc6f95]{pointer-events:auto}.upload-field__image[data-v-17bc6f95],.upload-field__image--remove[data-v-17bc6f95]{position:absolute;left:0;right:0;top:0;bottom:0}.upload-field__image--remove[data-v-17bc6f95]{display:none;z-index:1;background-color:rgba(0,0,0,.25);align-items:center;justify-content:center}.upload-field__normal[data-v-17bc6f95]{text-align:center}.upload-field__normal>i[data-v-17bc6f95]{color:#1967d2}.upload-field__normal>div>div[data-v-17bc6f95]{display:inline-block;text-decoration:underline;cursor:pointer;pointer-events:auto}",""]),e.exports=o},705:function(e,t,n){"use strict";n(592)},706:function(e,t,n){var o=n(24)(!1);o.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([e.i,".bbox__container[data-v-5aa31d42]{display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.04)}",""]),e.exports=o},718:function(e,t){},719:function(e,t){},727:function(e,t){},767:function(e,t){},768:function(e,t){},769:function(e,t){},821:function(e,t,n){"use strict";n.r(t),n.d(t,"dotp",(function(){return r})),n.d(t,"cosineSimilarity",(function(){return l}));n(6),n(72);var o=n(712),r=function(e,t){return e.map((function(a,i){return e[i]*t[i]})).reduce((function(a,b){return a+b}),0)},l=function(a,b){return o.a.cosine(a,b)}},822:function(e,t,n){var content=n(998);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(25).default)("79fb5ade",content,!0,{sourceMap:!1})},834:function(e,t,n){"use strict";n.r(t);n(47),n(6),n(32),n(62),n(48),n(26),n(9),n(63),n(66),n(49);var o=n(21),r=n(702),l=n.n(r);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw r}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var f={name:"UploadImageField",extends:n(517).a,inject:{form:{default:null}},props:{value:{type:String,default:""},accept:{type:String,default:"image/png,image/jpg"},imageMaxDimension:{type:Array,default:function(){return[640,640]}}},data:function(){return{localVal:"",original:null,fileCompressor:null,isDragging:!1,processing:!1}},watch:{value:function(e){this.localVal=e}},mounted:function(){this.valid=!0,this.localVal=this.value},methods:{validate:function(e,t){if(e){var n=[];t=t||this.localVal,e&&(this.hasInput=this.hasFocused=!0);var r,l=c(this.rules);try{for(l.s();!(r=l.n()).done;){var d=r.value,f="function"==typeof d?d(t):d;"string"==typeof f?n.push(f):"boolean"!=typeof f&&console.error("Rules should return a string or boolean, received '".concat(Object(o.a)(f),"' instead"),this)}}catch(e){l.e(e)}finally{l.f()}return this.errorBucket=n,this.valid=0===n.length,this.valid}},reset:function(){this.valid=!0,this.localVal="",this.original=null,this.errorBucket=[],this.$emit("input",this.localVal)},resetValidation:function(){this.valid=!0,this.errorBucket=[]},getFile:function(){return this.original},handelOnChangeFile:function(){this.onConvertImage()},handelOnDrop:function(e){if(e.preventDefault(),!this.disabled&&!this.localVal){this.isDragging=!1;var t=e.dataTransfer.files;this.$refs.picture_upload.files=t,this.onConvertImage()}},handelOnDragEnter:function(e){e.preventDefault(),this.disabled||this.localVal||(this.isDragging=!0)},handleOnDragLeave:function(e){this.disabled||this.localVal||(this.isDragging=!1)},handleDragOver:function(e){this.disabled||this.localVal||e.preventDefault()},onConvertImage:function(){var e=this,input=this.$refs.picture_upload.files;if(input&&input.length>0){var t=input[0];if("image/jpeg"!==t.type)return this.errorBucket.push("File not support"),void(this.valid=!1);this.processing=!0;this.fileCompressor=new l.a(t,{convertSize:5e6,maxWidth:this.imageMaxDimension[0],maxHeight:this.imageMaxDimension[1],success:function(t){var n=new FileReader;n.onload=e.onRead,n.readAsDataURL(t),e.original=t}})}},onRead:function(e){console.log("read"),this.localVal=e.target.result,this.$emit("input",this.localVal),this.$emit("change",this.localVal,this.original),this.$refs.picture_upload.value=null,this.$refs.picture_upload.type="text",this.$refs.picture_upload.type="file",this.validate(!0,this.localVal),this.processing=!1},handelOnRemove:function(){this.localVal="",this.original=null,this.$emit("input",this.localVal),this.$emit("change",this.localVal,this.original),this.validate(!0,this.localVal)}}},h=(n(703),n(67)),v=n(81),m=n.n(v),_=n(202),y=n(199),x=n(171),w=n(512),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-field",attrs:{id:e.id}},[n("div",{class:["upload-field__content",{"upload-field--error":!e.valid,"upload-field--disabled":e.disabled},{"upload-field-drop":e.isDragging}],attrs:{id:"upload_content"},on:{drop:e.handelOnDrop,dragover:e.handleDragOver,dragenter:e.handelOnDragEnter,dragleave:e.handleOnDragLeave}},[n("input",{ref:"picture_upload",attrs:{type:"file",alt:"",title:"",accept:e.accept},on:{input:e.handelOnChangeFile}}),e._v(" "),e.localVal?n("div",{staticClass:"upload-field__image"},[n("div",{staticClass:"upload-field__image--remove"},[n("v-icon",{attrs:{color:"white"},on:{click:e.handelOnRemove}},[e._v("mdi-delete")])],1),e._v(" "),n("v-img",{staticClass:"grey lighten-4",attrs:{src:e.localVal,width:"100%",height:"100%",contain:""}})],1):e.isDragging?n("div",{staticClass:"upload-field__drop-zone"},[n("v-avatar",{attrs:{color:"#1967d2"}},[n("v-icon",{attrs:{dark:""}},[e._v("mdi-tray-arrow-up")])],1),e._v(" "),n("div",{staticClass:"mt-4 text-subtitle-1 font-weight-light"},[e._v("Drop your image to here")])],1):n("div",{staticClass:"upload-field__normal"},[n("v-icon",{attrs:{size:"32"}},[e._v("mdi-image")]),e._v(" "),n("div",{staticClass:"text-subtitle-1 font-weight-light"},[e._v("Drag and drop or "),n("div",{on:{click:function(t){return e.$refs.picture_upload.click()}}},[e._v("browse")])])],1)]),e._v(" "),n("div",{class:["upload-field__details",{"upload-field__details--hide":e.hideDetails}]},[e.errorBucket.length<1&&e.hint&&(e.persistentHint||e.isFocused)?n("VMessages",{attrs:{value:[e.hint]}}):e._e(),e._v(" "),n("VMessages",{attrs:{value:e.errorBucket,color:"error"}})],1)])}),[],!1,null,"17bc6f95",null);t.default=component.exports;m()(component,{VAvatar:_.a,VIcon:y.a,VImg:x.a,VMessages:w.a})},835:function(e,t,n){"use strict";n.r(t);var o=n(27);n(91),n(28),n(72),n(47),n(6),n(32),n(62),n(48),n(26),n(9),n(63),n(66),n(49);function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){d=!0,r=e},f:function(){try{c||null==n.return||n.return()}finally{if(d)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var c={name:"BoundingBoxCanvas",props:{width:{type:Number,default:100},height:{type:Number,default:100},src:{type:String,default:null},bboxes:{type:Array,default:function(){return[]}}},data:function(){return{stageConfig:{width:100,height:100,scaleX:.5,scaleY:.5},imageConfig:{image:null,width:100,height:100,x:0,y:0},shapes:[],imageFactor:1}},watch:{src:function(e){this.loadImage(e)},bboxes:function(e){this.loadBox(e)},width:function(e){this.updateStageSize()}},mounted:function(){this.loadImage(this.src),this.loadBox(this.bboxes)},methods:{loadImage:function(e){var t=this;if(e){var image=new Image;image.onload=function(){t.imageConfig.image=image,t.imageConfig.width=image.width,t.imageConfig.height=image.height,t.updateStageSize()},image.src=e}},loadBox:function(e){if(Array.isArray(e)){var t=e.map((function(e,i){return{rotation:0,x:e.rectangle.x,y:e.rectangle.y,width:e.rectangle.width,height:e.rectangle.height,stroke:e.color,fill:e.color,strokeWidth:5,opacity:.6}}));this.shapes=t}},updateStageSize:function(){var e=Math.min(this.width/this.imageConfig.width,this.height/this.imageConfig.height);this.imageFactor=e;var t=this.calculateAspectRatioFit(this.imageConfig.width,this.imageConfig.height,this.width,this.height);this.stageConfig.width=t.width,this.stageConfig.height=t.height,this.stageConfig.scaleX=1*e,this.stageConfig.scaleY=1*e},calculateAspectRatioFit:function(e,t,n,o){var r=Math.min(n/e,o/t);return{width:e*r,height:t*r}},getImageData:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,l,c,d,f,h,v,m,_,y,x,img;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.$refs.background.getNode(),l=o.width()/t.stageConfig.width,c=o.height()/t.stageConfig.height,d=[],f=r(e),n.prev=5,f.s();case 7:if((h=f.n()).done){n.next=19;break}return v=h.value,m=parseInt(Math.round(v.rectangle.x/l)),_=parseInt(Math.round(v.rectangle.y/c)),y=parseInt(Math.round(v.rectangle.width/l)),x=parseInt(Math.round(v.rectangle.height/c)),n.next=15,o.toImage({x:m,y:_,width:y,height:x});case 15:img=n.sent,d.push(img);case 17:n.next=7;break;case 19:n.next=24;break;case 21:n.prev=21,n.t0=n.catch(5),f.e(n.t0);case 24:return n.prev=24,f.f(),n.finish(24);case 27:return n.abrupt("return",d);case 28:case"end":return n.stop()}}),n,null,[[5,21,24,27]])})))()},reset:function(){this.imageConfig.image=null,this.shapes=[]}}},d=(n(705),n(67)),component=Object(d.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bbox__container",style:{width:e.width+"px",height:e.height+"px"}},[n("v-stage",{ref:"stage",staticClass:"bbox__stage",attrs:{config:e.stageConfig}},[n("v-layer",{ref:"layer"},[n("v-image",{ref:"background",attrs:{config:e.imageConfig}}),e._v(" "),e._l(e.shapes,(function(e,i){return[n("v-rect",{key:"shape-"+i,attrs:{config:e}})]}))],2)],1)],1)}),[],!1,null,"5aa31d42",null);t.default=component.exports},907:function(e,t){},909:function(e,t){},919:function(e,t){},921:function(e,t){},946:function(e,t){},947:function(e,t){},952:function(e,t){},954:function(e,t){},961:function(e,t){},980:function(e,t){},997:function(e,t,n){"use strict";n(822)},998:function(e,t,n){var o=n(24)(!1);o.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([e.i,".ad-detection-page[data-v-4bedfcdf]{padding:8px;display:flex;align-items:center;justify-content:center}.ad-detection-database[data-v-4bedfcdf]{padding-top:8px;display:flex}.ad-detection-database-list[data-v-4bedfcdf]{overflow:hidden;overflow-x:auto;margin-left:8px;display:flex}.ad-detection-database-item[data-v-4bedfcdf]{width:58px;height:58px;position:relative}.ad-detection-database-item:hover .ad-detection-database-item__remove[data-v-4bedfcdf]{display:flex;align-items:center;justify-content:center;cursor:pointer}.ad-detection-database-item__remove[data-v-4bedfcdf]{display:none;position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.2)}.ad-detection-database-list>.ad-detection-database-item+.ad-detection-database-item[data-v-4bedfcdf]{margin-left:4px}.ad-detection-workspace[data-v-4bedfcdf]{display:flex}.ad-detection-workspace__canvas[data-v-4bedfcdf]{flex:0}.ad-detection-workspace__output[data-v-4bedfcdf]{flex:1}.ad-detection__overlay-box[data-v-4bedfcdf]{min-width:320px;text-align:center;background-color:#fff;padding:32px 16px;color:#212121;border-radius:4px}.ad-detection__container[data-v-4bedfcdf]{max-width:800px;width:100%;margin:auto}.ad-detection-upload-btn[data-v-4bedfcdf]{width:72px;height:58px;padding:4px 8px;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:#e8f0fe;border-radius:4px;cursor:pointer;position:relative}.ad-detection-upload-btn>input[data-v-4bedfcdf]{display:none}.ad-detection-upload-btn>.ad-detection-upload-btn__text[data-v-4bedfcdf],.ad-detection-upload-btn>i[data-v-4bedfcdf]{color:#1967d2}.ad-detection-upload-btn>.ad-detection-upload-btn__text[data-v-4bedfcdf]{font-size:.8rem}.ad-detection-upload-btn[data-v-4bedfcdf]:hover{background-color:#d2e3fc}.ad-detection-results[data-v-4bedfcdf]{overflow:hidden;overflow-y:auto}.ad-detection-results__title[data-v-4bedfcdf]{font-size:1.1rem;font-weight:600}.ad-detection-results__item[data-v-4bedfcdf]{display:flex;align-items:center;padding:16px 0}.ad-detection-results__color-box[data-v-4bedfcdf]{width:5px;min-height:100%;margin-right:8px;align-self:stretch}.ad-detection-results__label[data-v-4bedfcdf]{margin-right:8px;max-width:30%;width:30%}.ad-detection-results__percent[data-v-4bedfcdf]{flex:1}",""]),e.exports=o}}]);