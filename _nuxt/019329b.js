(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1038:function(e,t,n){"use strict";n(887)},1039:function(e,t,n){var o=n(55)(!1);o.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([e.i,".ad-detection-btn--up[data-v-42bfad82]{transform:rotate(180deg)}.ad-detection-btn--down[data-v-42bfad82]{transform:rotate(0deg)}.ad-detection-page[data-v-42bfad82]{padding:8px;display:flex;align-items:center;justify-content:center}.ad-detection-database[data-v-42bfad82]{padding-top:8px;display:flex}.ad-detection-database-list[data-v-42bfad82]{overflow:hidden;overflow-x:auto;margin-left:8px;display:flex}.ad-detection-database-item[data-v-42bfad82]{width:58px;height:58px;position:relative}.ad-detection-database-item:hover .ad-detection-database-item__remove[data-v-42bfad82]{display:flex;align-items:center;justify-content:center;cursor:pointer}.ad-detection-database-item__remove[data-v-42bfad82]{display:none;position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.2)}.ad-detection-database-list>.ad-detection-database-item+.ad-detection-database-item[data-v-42bfad82]{margin-left:4px}.ad-detection-workspace[data-v-42bfad82]{display:flex}.ad-detection-workspace__canvas[data-v-42bfad82]{flex:0}.ad-detection-workspace__output[data-v-42bfad82]{flex:1}.ad-detection__overlay-box[data-v-42bfad82]{min-width:320px;text-align:center;background-color:#fff;padding:32px 16px;color:#212121;border-radius:4px}.ad-detection__container[data-v-42bfad82]{max-width:800px;width:100%;margin:auto}.ad-detection__footer[data-v-42bfad82]{display:flex;justify-content:flex-end;position:absolute;bottom:16px;left:16px;right:16px;max-height:24px;overflow:hidden}.ad-detection__footer--text[data-v-42bfad82]{color:#aaa;font-size:.7rem}.ad-detection-upload-btn[data-v-42bfad82]{width:72px;height:58px;padding:4px 8px;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:#e8f0fe;border-radius:4px;cursor:pointer;position:relative}.ad-detection-upload-btn>input[data-v-42bfad82]{display:none}.ad-detection-upload-btn>.ad-detection-upload-btn__text[data-v-42bfad82],.ad-detection-upload-btn>i[data-v-42bfad82]{color:#1967d2}.ad-detection-upload-btn>.ad-detection-upload-btn__text[data-v-42bfad82]{font-size:.8rem}.ad-detection-upload-btn[data-v-42bfad82]:hover{background-color:#d2e3fc}.ad-detection-results[data-v-42bfad82]{overflow:hidden;overflow-y:auto}.ad-detection-results__title[data-v-42bfad82]{font-size:1.1rem;font-weight:600}.ad-detection-results__item[data-v-42bfad82]{display:flex;align-items:center;padding:16px 0}.ad-detection-results__color-box[data-v-42bfad82]{width:5px;min-height:100%;margin-right:8px;align-self:stretch}.ad-detection-results__label[data-v-42bfad82]{margin-right:8px;max-width:30%;width:30%}.ad-detection-results__percent[data-v-42bfad82]{flex:1}",""]),e.exports=o},1040:function(e,t){e.exports=function(component,e){var t="function"==typeof component.exports?component.exports.extendOptions:component.options;for(var i in"function"==typeof component.exports&&(t.directives=component.exports.options.directives),t.directives=t.directives||{},e)t.directives[i]=t.directives[i]||e[i]}},1054:function(e,t,n){"use strict";n.r(t);n(162),n(40),n(37),n(38),n(45),n(39),n(46),n(96),n(69),n(128),n(95),n(57),n(129),n(137),n(97);var o=n(15),r=n(63),l=n(91),d=n(81),c=n(60),f=n(62),v=n(61),h=(n(187),n(65),n(403),n(356),n(150),n(25),n(275),n(244)),m=n(816),_=n.n(m),x=n(777);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){d=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(d)throw r}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function D(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?D(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):D(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(c.a)(e);if(t){var r=Object(c.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(d.a)(this,n)}}var C=Object(f.a)((function e(t){return Object(v.a)(this,e),h.regularizers.l1l2(t)}));C.className="L2",h.serialization.registerClass(C);var T=function(e){Object(l.a)(n,e);var t=O(n);function n(){return Object(v.a)(this,n),t.call(this,{})}return Object(f.a)(n,null,[{key:"className",get:function(){return"Lambda"}}]),n}(h.layers.Layer);h.serialization.registerClass(T);var V={name:"AdDetectionPage",layout:"ml",data:function(){return{title:"Offline-advertising Detection",loading:{show:!0,message:"Getting model version..."},databases:[],uploadDatabaseDialog:!1,createDatabaseValid:!0,createDatabase:{label:"",img:[]},initializing:!0,databaseUploading:!1,testUploading:!1,isPreviewUploaded:!1,embeddingModel:null,screenWidth:100,canvasWidth:100,canvasHeight:100,sampleImgs:[],bboxes:[],knn:null,hasProblem:!1,classificationThresholdDialog:!1,tempClassificationThreshold:.7,minimumClassificationThreshold:.7,localizationThresholdDialog:!1,tempLocalizationThreshold:.6,minimumLocalizationThreshold:.6,confidenceValid:!0,hasChangVersion:!1,modelVersion:0,hideArtWork:!1}},head:function(){return{title:this.title}},mounted:function(){this.initialize()},methods:{initialize:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.initializing=!0,e.loading.message="Getting model version...",e.loading.show=!0,t.next=6,e.getModelVersion();case 6:if(e.loading.message="Loading model...",!localStorage.getItem("detection-offline-ad")){t.next=15;break}return t.next=11,h.loadLayersModel("indexeddb://detection-offline-ad");case 11:n=t.sent,e.embeddingModel=n,t.next=22;break;case 15:return t.next=17,h.loadLayersModel("https://storage.googleapis.com/demo-ml-model/detection-offline-ad/model.json");case 17:return o=t.sent,e.embeddingModel=o,t.next=21,o.save("indexeddb://detection-offline-ad");case 21:localStorage.setItem("detection-offline-ad",!0);case 22:e.loading.message="Loading database...",e.loadDatabaseLocalStorage(),e.hasChangVersion&&(e.loading.message="Re-generate database...",e.reversionDatabase()),null!==(r=localStorage.getItem("offline-ad-classification-threshold"))&&(e.minimumClassificationThreshold=Number(r)),null!==(l=localStorage.getItem("offline-ad-localization-threshold"))&&(e.minimumLocalizationThreshold=Number(l)),t.next=34;break;case 31:t.prev=31,t.t0=t.catch(0),console.error(t.t0);case 34:return t.prev=34,e.initializing=!1,e.loading.show=!1,t.finish(34);case 38:case"end":return t.stop()}}),t,null,[[0,31,34,38]])})))()},onResize:function(){var e=document.querySelector("#workspace");if(this.screenWidth=window.innerWidth,e){var t=e.offsetWidth-32,n=this.screenWidth>560?.6:1;this.canvasWidth=Math.round(t*n),this.canvasHeight=this.canvasWidth}},resizeCanvas:function(){var e=document.querySelector("#workspace");e&&console.log(e.offsetWidth)},handleAddDatabase:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,image,o,r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$refs.database_form.validate()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,n=JSON.parse(JSON.stringify(e.createDatabase)),e.uploadDatabaseDialog=!1,e.databaseUploading=!0,e.loading.message="Adding Image to database...",e.loading.show=!0,t.next=10,e.base64ToImage(e.createDatabase.img[0]);case 10:image=t.sent,o=e.getEmbedded(image),console.log("vector",o),r=Date.now(),l=_()(r).toHex(),e.databases.push({id:r,img:n.img[0],label:n.label,embedded:o,color:l}),e.trainingModel(e.databases),e.updateDatabaseLocalStorage(e.databases),t.next=22;break;case 20:t.prev=20,t.t0=t.catch(2);case 22:return t.prev=22,e.databaseUploading=!1,e.createDatabase.img=null,e.createDatabase.label="",e.loading.show=!1,t.finish(22);case 28:case"end":return t.stop()}}),t,null,[[2,20,22,28]])})))()},handleOnRemoveDatabase:function(e){if(e)try{var t=this.databases.findIndex((function(t){return t.id===e}));t>-1&&(this.databases.splice(t,1),this.trainingModel(this.databases),this.updateDatabaseLocalStorage(this.databases))}catch(e){console.error("remove database error",e)}},handleOnUploadPreview:function(e){console.log("select file",e)},getOfflineAd:function(image){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var body,n,o,r,i,l,d,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return body={image:image,threshold:e.minimumLocalizationThreshold},t.next=3,e.$axios.$post("https://ad-detection-service-bxltsvmqda-as.a.run.app/ads/detection",body);case 3:return n=t.sent,t.next=6,e.$refs.image_canvas.getImageData(n.objects);case 6:for(i in o=t.sent,r=[],o)l=o[i],d=e.getEmbedded(l),(c=e.querySimilarity(d))&&r.push(k(k({},n.objects[i]),{},{object:c.label,score:c.score,color:c.color}));e.bboxes=r;case 10:case"end":return t.stop()}}),t)})))()},trainingModel:function(e){var t=e.map((function(e){return e.embedded})),n=e.map((function(e){return e.id}));this.knn={embedded:t,labels:n}},base64ToImage:function(e){return new Promise((function(t,n){var image=new Image;image.onload=function(){t(image)},image.src=e}))},getEmbedded:function(img){var e=h.browser.fromPixels(img).resizeNearestNeighbor([224,224]).toFloat().div(h.scalar(255)).expandDims();return this.embeddingModel.predict(e).arraySync()[0]},querySimilarity:function(e){var t=this.knn.embedded,n=this.knn.labels,o=-1,r=0;for(var i in t){var l=t[i],d=Object(x.cosineSimilarity)(l,e);console.log(d,this.queryDatabase(n[i])),d>r&&(o=n[i],r=d)}if(-1===o||r<this.minimumClassificationThreshold)return null;var c=this.queryDatabase(o);return{id:o,label:null==c?void 0:c.label,score:r,color:null==c?void 0:c.color}},queryDatabase:function(e){return this.databases.find((function(t){return t.id===e}))},handleOnDeletePreview:function(){this.sampleImgs=null,this.bboxes=[],this.isPreviewUploaded=!1},handleOnDeleteDatabase:function(){try{this.databases=[],localStorage.removeItem("offline-ad-databases")}catch(e){console.error("remove database",e)}},handleOnUploadDatabase:function(){var e=this;this.uploadDatabaseDialog=!0,this.$nextTick((function(){e.$refs.database_form.reset(),e.$refs.database_form.resetValidation()}))},chkLabelDuplicate:function(label){return!this.databases.find((function(e){return e.label===label}))||"Label already exists."},handleOnReloadPage:function(){window.location.reload()},getModelVersion:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$get("https://storage.googleapis.com/demo-ml-model/detection-offline-ad/version.json");case 3:n=t.sent,o=localStorage.getItem("detection-offline-ad-version"),e.hasChangVersion=!1,o!==n.version&&(localStorage.removeItem("detection-offline-ad"),window.indexedDB.deleteDatabase("detection-offline-ad"),localStorage.setItem("detection-offline-ad-version",n.version),e.hasChangVersion=!0),e.modelVersion=n.version,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),e.hasProblem=!0;case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},loadDatabaseLocalStorage:function(){try{var e=localStorage.getItem("offline-ad-databases");e&&(this.databases=JSON.parse(e),this.trainingModel(this.databases))}catch(e){console.error("load database error",e)}},updateDatabaseLocalStorage:function(e){try{localStorage.setItem("offline-ad-databases",JSON.stringify(e))}catch(e){console.error("update database error",e)}},handleOnLocalizationThreshold:function(){this.tempLocalizationThreshold=this.minimumLocalizationThreshold,this.localizationThresholdDialog=!0},handleOnClassificationThreshold:function(){this.tempClassificationThreshold=this.minimumClassificationThreshold,this.classificationThresholdDialog=!0},handelOnSaveClassificationThreshold:function(){try{this.minimumClassificationThreshold=this.tempClassificationThreshold,this.classificationThresholdDialog=!1,localStorage.setItem("offline-ad-classification-threshold",this.minimumClassificationThreshold)}catch(e){console.error("update minimum confidence error",e)}},handleOnClassificationDecrement:function(){this.tempClassificationThreshold-=.1},handleOnClassificationIncrement:function(){this.tempClassificationThreshold+=.1},handelOnSaveLocalizationThreshold:function(){try{this.minimumLocalizationThreshold=this.tempLocalizationThreshold,this.localizationThresholdDialog=!1,console.log(this.minimumLocalizationThreshold),localStorage.setItem("offline-ad-localization-threshold",this.minimumLocalizationThreshold)}catch(e){console.error("update minimum confidence error",e)}},handleOnLocalizationDecrement:function(){this.tempLocalizationThreshold-=.1},handleOnLocalizationIncrement:function(){this.tempLocalizationThreshold+=.1},reversionDatabase:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,o,r,image;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=y(e.databases),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=11;break}return r=o.value,t.next=7,e.base64ToImage(r.img);case 7:image=t.sent,r.embedded=e.getEmbedded(image);case 9:t.next=3;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),n.e(t.t0);case 16:return t.prev=16,n.f(),t.finish(16);case 19:console.log("update reversion",e.databases),e.trainingModel(e.databases),e.updateDatabaseLocalStorage(e.databases);case 22:case"end":return t.stop()}}),t,null,[[1,13,16,19]])})))()},handleOnDetectAgain:function(){this.handleOnUploadPreview(this.sampleImgs)}}},z=(n(1038),n(138)),S=n(160),I=n.n(S),j=n(544),L=n(879),A=n(742),R=n(1047),P=n(1002),M=n(397),$=n(1003),W=n(381),U=n(351),E=n(382),N=n(266),B=n(188),F=n(1049),J=n(386),H=n(1050),G=n(728),K=n(1058),Y=n(1051),Q=n(1040),X=n.n(Q),Z=n(398),component=Object(z.a)(V,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"ad-detection-page fill-height"},[n("div",{staticClass:"ad-detection__container"},[n("v-fade-transition",[n("v-card",[n("v-card-title",{staticClass:"py-2"},[n("v-btn",{class:["mr-2",e.hideArtWork?"ad-detection-btn--up":"ad-detection-btn--down"],attrs:{icon:""},on:{click:function(t){e.hideArtWork=!e.hideArtWork}}},[n("v-icon",[e._v("mdi-chevron-down")])],1),e._v(" "),n("div",[e._v("Artwork")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),o),[n("v-icon",[e._v("mdi-dots-vertical")])],1)]}}])},[e._v(" "),n("v-list",[n("v-list-item",{on:{click:e.handleOnLocalizationThreshold}},[n("v-list-item-title",[e._v("Localization threshold")])],1),e._v(" "),n("v-list-item",{on:{click:e.handleOnClassificationThreshold}},[n("v-list-item-title",[e._v("Similarity threshold")])],1),e._v(" "),n("v-list-item",{attrs:{disabled:e.databases.length<1},on:{click:e.handleOnDeleteDatabase}},[n("v-list-item-title",{staticClass:"error--text"},[e._v("Delete Database")])],1)],1)],1)],1),e._v(" "),n("v-divider",{directives:[{name:"show",rawName:"v-show",value:!e.hideArtWork,expression:"!hideArtWork"}]}),e._v(" "),n("v-card-text",{directives:[{name:"show",rawName:"v-show",value:!e.hideArtWork,expression:"!hideArtWork"}]},[e.databases.length>0?n("div",[e._v("\n            "+e._s(e.databases.length)+" Annotation\n          ")]):n("div",[e._v("Add Annotation:")]),e._v(" "),n("div",{staticClass:"ad-detection-database"},[n("div",{staticClass:"ad-detection-upload-btn",on:{click:e.handleOnUploadDatabase}},[n("v-icon",{attrs:{size:"18"}},[e._v("mdi-tray-arrow-up")]),e._v(" "),n("div",{staticClass:"ad-detection-upload-btn__text"},[e._v("Upload")])],1),e._v(" "),n("div",{staticClass:"ad-detection-database-list"},[e._l(e.databases,(function(t){return[n("div",{key:t.id,staticClass:"ad-detection-database-item"},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(o){var r=o.on,l=o.attrs;return[n("div",e._g(e._b({},"div",l,!1),r),[n("v-img",{attrs:{src:t.img,width:"100%",contain:""}}),e._v(" "),n("div",{staticClass:"ad-detection-database-item__remove"},[n("v-icon",{attrs:{color:"white"},on:{click:function(n){return e.handleOnRemoveDatabase(t.id)}}},[e._v("mdi-close-circle")])],1)],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.label))])])],1)]}))],2)])])],1)],1),e._v(" "),n("v-card",{staticClass:"mt-4",attrs:{id:"workspace"}}),e._v(" "),n("v-card",{staticClass:"mt-4",attrs:{id:"workspace"}},[n("v-card-title",{staticClass:"py-2"},[n("div",[e._v("Preview")]),e._v(" "),n("v-spacer"),e._v(" "),e.sampleImgs?n("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",r,!1),o),[n("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750)},[e._v(" "),n("v-list",[1===e.sampleImgs.length?n("v-list-item",{attrs:{disabled:!e.sampleImgs},on:{click:e.handleOnDetectAgain}},[n("v-list-item-title",[e._v("Detect Again")])],1):e._e(),e._v(" "),n("v-list-item",{attrs:{disabled:!e.sampleImgs},on:{click:e.handleOnDeletePreview}},[n("v-list-item-title",{staticClass:"error--text"},[e._v("Delete Preview")])],1)],1)],1):e._e()],1),e._v(" "),n("v-divider"),e._v(" "),e.databases.length>0&&!e.isPreviewUploaded?n("v-card-text",[n("upload-image-field",{ref:"upload_test",staticStyle:{width:"100%"},attrs:{"add-text":"Click to upload",accept:"image/jpeg",multiple:""},on:{change:e.handleOnUploadPreview},model:{value:e.sampleImgs,callback:function(t){e.sampleImgs=t},expression:"sampleImgs"}})],1):n("v-card-text",[e._v("\n        You must add artwork on top panel before you can preview it here\n      ")])],1)],1),e._v(" "),n("div",{staticClass:"ad-detection__footer"},[n("div",{staticClass:"ad-detection__footer--text"},[e._v("version: "+e._s(e.modelVersion))])]),e._v(" "),n("v-dialog",{attrs:{"max-width":"480",persistent:""},model:{value:e.uploadDatabaseDialog,callback:function(t){e.uploadDatabaseDialog=t},expression:"uploadDatabaseDialog"}},[n("v-card",[n("v-card-title",[e._v("Add new artwork")]),e._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("v-form",{ref:"database_form",on:{submit:function(e){e.preventDefault()}},model:{value:e.createDatabaseValid,callback:function(t){e.createDatabaseValid=t},expression:"createDatabaseValid"}},[n("v-text-field",{attrs:{label:"Label",rules:[function(e){return!!e||"Enter label name"},e.chkLabelDuplicate],dense:"",outlined:""},model:{value:e.createDatabase.label,callback:function(t){e.$set(e.createDatabase,"label",t)},expression:"createDatabase.label"}}),e._v(" "),n("upload-image-field",{ref:"upload_database",staticStyle:{width:"100%"},attrs:{rules:[function(e){return!!e||"Enter image"}],"add-text":"Click to upload",accept:"image/jpeg"},model:{value:e.createDatabase.img,callback:function(t){e.$set(e.createDatabase,"img",t)},expression:"createDatabase.img"}})],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.uploadDatabaseDialog=!1}}},[e._v("cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handleAddDatabase}},[e._v("add")])],1)],1)],1),e._v(" "),n("v-overlay",{model:{value:e.loading.show,callback:function(t){e.$set(e.loading,"show",t)},expression:"loading.show"}},[n("div",{staticClass:"ad-detection__overlay-box"},[e._v(e._s(e.loading.message))])]),e._v(" "),n("v-dialog",{attrs:{"max-width":"640",persistent:""},model:{value:e.hasProblem,callback:function(t){e.hasProblem=t},expression:"hasProblem"}},[n("v-card",[n("v-card-text",{staticClass:"py-4 text-center"},[n("div",{staticClass:"py-3"},[n("v-icon",{attrs:{color:"primary",size:"48"}},[e._v("mdi-connection")])],1),e._v(" "),n("div",{staticClass:"text-h6"},[e._v("Something went wrong...")]),e._v(" "),n("div",{staticClass:"text-body-2 pb-6"},[e._v("\n          We are working on fixing the problem Please try again.\n        ")]),e._v(" "),n("v-btn",{attrs:{color:"primary",plain:""},on:{click:e.handleOnReloadPage}},[n("v-icon",{attrs:{left:""}},[e._v("mdi-refresh")]),e._v("\n          Refresh Page\n        ")],1)],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"320",persistent:""},model:{value:e.classificationThresholdDialog,callback:function(t){e.classificationThresholdDialog=t},expression:"classificationThresholdDialog"}},[n("v-card",[n("v-card-title",[e._v("Similarity Threshold")]),e._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("div",{staticClass:"text-h4 font-weight-light"},[e._v("\n          "+e._s(e.tempClassificationThreshold)+"\n        ")]),e._v(" "),n("v-slider",{attrs:{max:"1",min:"0",step:"0.1",color:"primary","track-color":"grey","always-dirty":"","hide-details":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnClassificationDecrement}},[e._v("\n              mdi-minus\n            ")])]},proxy:!0},{key:"append",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnClassificationIncrement}},[e._v("\n              mdi-plus\n            ")])]},proxy:!0}]),model:{value:e.tempClassificationThreshold,callback:function(t){e.tempClassificationThreshold=t},expression:"tempClassificationThreshold"}})],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.classificationThresholdDialog=!1}}},[e._v("cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handelOnSaveClassificationThreshold}},[e._v("Save")])],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"320",persistent:""},model:{value:e.localizationThresholdDialog,callback:function(t){e.localizationThresholdDialog=t},expression:"localizationThresholdDialog"}},[n("v-card",[n("v-card-title",[e._v("Localization Threshold")]),e._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("div",{staticClass:"text-h4 font-weight-light"},[e._v("\n          "+e._s(e.tempLocalizationThreshold)+"\n        ")]),e._v(" "),n("v-slider",{attrs:{max:"1",min:"0",step:"0.1",color:"primary","track-color":"grey","always-dirty":"","hide-details":""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnLocalizationDecrement}},[e._v("\n              mdi-minus\n            ")])]},proxy:!0},{key:"append",fn:function(){return[n("v-icon",{attrs:{color:"primary"},on:{click:e.handleOnLocalizationIncrement}},[e._v("\n              mdi-plus\n            ")])]},proxy:!0}]),model:{value:e.tempLocalizationThreshold,callback:function(t){e.tempLocalizationThreshold=t},expression:"tempLocalizationThreshold"}})],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(t){e.localizationThresholdDialog=!1}}},[e._v("cancel")]),e._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:e.handelOnSaveLocalizationThreshold}},[e._v("Save")])],1)],1)],1)],1)}),[],!1,null,"42bfad82",null);t.default=component.exports;I()(component,{UploadImageField:n(780).default}),I()(component,{VBtn:j.a,VCard:L.a,VCardActions:A.a,VCardText:A.b,VCardTitle:A.c,VDialog:R.a,VDivider:P.a,VFadeTransition:M.c,VForm:$.a,VIcon:W.a,VImg:U.a,VList:E.a,VListItem:N.a,VListItemTitle:B.b,VMenu:F.a,VOverlay:J.a,VSlider:H.a,VSpacer:G.a,VTextField:K.a,VTooltip:Y.a}),X()(component,{Resize:Z.a})},741:function(e,t,n){var content=n(769);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(56).default)("5d7ada4c",content,!0,{sourceMap:!1})},768:function(e,t,n){"use strict";n(741)},769:function(e,t,n){var o=n(55)(!1);o.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([e.i,".upload-field[data-v-b5ade68e]{position:relative}.upload-field__content[data-v-b5ade68e]{border:thin dashed #1967d2!important;border-radius:4px;padding:8px;display:flex;align-items:center;justify-content:center;position:relative;margin-bottom:4px;width:100%;height:240px;background-color:#e8f0fe;overflow:hidden;z-index:1;color:#1967d2!important}.upload-field__content *[data-v-b5ade68e]{pointer-events:none}.upload-field__content>input[data-v-b5ade68e]{display:none}.upload-field__drop-zone[data-v-b5ade68e]{text-align:center}.upload-field--error[data-v-b5ade68e]{border:2px solid #ff5252!important}.upload-field__disabled[data-v-b5ade68e]{position:absolute;top:0;bottom:0;left:0;right:0}.upload-field__details[data-v-b5ade68e]{margin-bottom:8px;padding:0 12px;display:flex;flex:1 0 auto;max-width:100%;min-height:14px;overflow:hidden}.upload-field__details--hide[data-v-b5ade68e]{display:none!important}.upload-field--readonly[data-v-b5ade68e]{cursor:auto}.upload-field:hover .upload-field__image--remove[data-v-b5ade68e]{display:flex}.upload-field:hover .upload-field__image--remove>*[data-v-b5ade68e]{pointer-events:auto}.upload-field__image[data-v-b5ade68e],.upload-field__image--remove[data-v-b5ade68e]{position:absolute;left:0;right:0;top:0;bottom:0}.upload-field__image--remove[data-v-b5ade68e]{display:none;z-index:1;background-color:rgba(0,0,0,.25);align-items:center;justify-content:center}.upload-field__normal[data-v-b5ade68e]{text-align:center}.upload-field__normal>i[data-v-b5ade68e]{color:#1967d2}.upload-field__normal>div>div[data-v-b5ade68e]{display:inline-block;text-decoration:underline;cursor:pointer;pointer-events:auto}",""]),e.exports=o},777:function(e,t,n){"use strict";n.r(t),n.d(t,"cosineSimilarity",(function(){return r}));var o=n(779),r=function(a,b){return o.a.cosine(a,b)}},780:function(e,t,n){"use strict";n.r(t);n(96),n(69),n(128),n(95),n(37),n(129),n(137),n(97);var o=n(51),r=n(63),l=n(49),d=(n(187),n(25),n(38),n(150),n(57),n(159),n(151),n(117),n(136),n(806)),c=n.n(d);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){d=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(d)throw r}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h={name:"UploadImageField",extends:n(739).a,inject:{form:{default:null}},props:{value:{type:Array,default:function(){return[]}},accept:{type:String,default:"image/png,image/jpg"},imageMaxDimension:{type:Array,default:function(){return[640,640]}},multiple:{type:Boolean,default:!1}},data:function(){return{localVal:[],raws:[],fileCompressor:null,isDragging:!1,processing:!1}},watch:{value:function(e){this.localVal=e||[]}},mounted:function(){this.valid=!0,this.localVal=this.value},methods:{validate:function(e,t){if(e){var n=[];t=t||this.localVal,e&&(this.hasInput=this.hasFocused=!0);var o,r=f(this.rules);try{for(r.s();!(o=r.n()).done;){var d=o.value,c="function"==typeof d?d(t):d;"string"==typeof c?n.push(c):"boolean"!=typeof c&&console.error("Rules should return a string or boolean, received '".concat(Object(l.a)(c),"' instead"),this)}}catch(e){r.e(e)}finally{r.f()}return this.errorBucket=n,this.valid=0===n.length,this.valid}},reset:function(){this.valid=!0,this.localVal=[],this.raws=[],this.errorBucket=[],this.$emit("input",this.localVal)},resetValidation:function(){this.valid=!0,this.errorBucket=[]},getRaws:function(){return this.raws},handelOnChangeFile:function(){this.onConvertImage()},handelOnDrop:function(e){if(e.preventDefault(),!(this.disabled||this.localVal.length>0)){this.isDragging=!1;var t=e.dataTransfer.files;this.$refs.picture_upload.files=t,this.onConvertImage()}},handelOnDragEnter:function(e){e.preventDefault(),this.disabled||this.localVal.length>0||(this.isDragging=!0)},handleOnDragLeave:function(e){this.disabled||this.localVal.length>0||(this.isDragging=!1)},handleDragOver:function(e){this.disabled||this.localVal.length>0||e.preventDefault()},parseImage:function(e){var t=this;return new Promise((function(n,o){var r,l=function(e){n([e.target.result,r])};t.fileCompressor=new c.a(e,{convertSize:5e6,maxWidth:t.imageMaxDimension[0],maxHeight:t.imageMaxDimension[1],success:function(e){var t=new FileReader;t.onload=l,r=e,t.readAsDataURL(r)},error:o})}))},onConvertImage:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,l,d,c,v,h,m,_,img,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=e.$refs.picture_upload.files,e.multiple||(n=[n[0]]),r=e.accept.split(",").map((function(e){return e.trim()})).filter((function(e){return!!e})),l=[],d=[],e.processing=!0,c=f(n),t.prev=8,c.s();case 10:if((v=c.n()).done){t.next=24;break}if(h=v.value,r.includes(h.type)){t.next=14;break}throw new Error("Some file not support");case 14:return t.next=16,e.parseImage(h);case 16:m=t.sent,_=Object(o.a)(m,2),img=_[0],x=_[1],d.push(img),l.push(x);case 22:t.next=10;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(8),c.e(t.t0);case 29:return t.prev=29,c.f(),t.finish(29);case 32:e.localVal=d,e.raws=l,e.$refs.picture_upload.value=null,e.$refs.picture_upload.type="text",e.$refs.picture_upload.type="file",e.$emit("input",e.localVal),e.$emit("change",e.localVal,e.raws),e.validate(!0,e.localVal),t.next=47;break;case 42:t.prev=42,t.t1=t.catch(0),console.error(t.t1),e.errorBucket[0]=t.t1.message,e.valid=!1;case 47:return t.prev=47,e.processing=!1,t.finish(47);case 50:case"end":return t.stop()}}),t,null,[[0,42,47,50],[8,26,29,32]])})))()},handelOnRemove:function(){this.localVal=[],this.raws=[],this.$emit("input",this.localVal),this.$emit("change",this.localVal,this.raws),this.validate(!0,this.localVal)}}},m=(n(768),n(138)),_=n(160),x=n.n(_),y=n(384),w=n(381),D=n(351),k=n(740),component=Object(m.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-field",attrs:{id:e.id}},[n("div",{class:["upload-field__content",{"upload-field--error":!e.valid,"upload-field--disabled":e.disabled},{"upload-field-drop":e.isDragging}],attrs:{id:"upload_content"},on:{drop:e.handelOnDrop,dragover:e.handleDragOver,dragenter:e.handelOnDragEnter,dragleave:e.handleOnDragLeave}},[n("input",{ref:"picture_upload",attrs:{type:"file",alt:"",title:"",accept:e.accept,multiple:e.multiple},on:{input:e.handelOnChangeFile}}),e._v(" "),e.multiple||1!==e.localVal.length?e.isDragging?n("div",{staticClass:"upload-field__drop-zone"},[n("v-avatar",{attrs:{color:"#1967d2"}},[n("v-icon",{attrs:{dark:""}},[e._v("mdi-tray-arrow-up")])],1),e._v(" "),n("div",{staticClass:"mt-4 text-subtitle-1 font-weight-light"},[e._v("Drop your image to here")])],1):n("div",{staticClass:"upload-field__normal"},[n("v-icon",{attrs:{size:"32"}},[e._v("mdi-image")]),e._v(" "),n("div",{staticClass:"text-subtitle-1 font-weight-light"},[e._v("Drag and drop or "),n("div",{on:{click:function(t){return e.$refs.picture_upload.click()}}},[e._v("browse")])])],1):n("div",{staticClass:"upload-field__image"},[n("div",{staticClass:"upload-field__image--remove"},[n("v-icon",{attrs:{color:"white"},on:{click:e.handelOnRemove}},[e._v("mdi-delete")])],1),e._v(" "),e.multiple||1!==e.localVal.length?e._e():n("v-img",{staticClass:"grey lighten-4",attrs:{src:e.localVal[0],width:"100%",height:"100%",contain:""}})],1)]),e._v(" "),n("div",{class:["upload-field__details",{"upload-field__details--hide":e.hideDetails}]},[e.errorBucket.length<1&&e.hint&&(e.persistentHint||e.isFocused)?n("VMessages",{attrs:{value:[e.hint]}}):e._e(),e._v(" "),n("VMessages",{attrs:{value:e.errorBucket,color:"error"}})],1)])}),[],!1,null,"b5ade68e",null);t.default=component.exports;x()(component,{VAvatar:y.a,VIcon:w.a,VImg:D.a,VMessages:k.a})},820:function(e,t){},821:function(e,t){},830:function(e,t){},831:function(e,t){},850:function(e,t){},852:function(e,t){},855:function(e,t){},856:function(e,t){},861:function(e,t){},868:function(e,t){},887:function(e,t,n){var content=n(1039);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(56).default)("10364b17",content,!0,{sourceMap:!1})}}]);