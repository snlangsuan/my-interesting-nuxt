(window.webpackJsonp=window.webpackJsonp||[]).push([[11,6],{563:function(t,e,n){var content=n(647);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(25).default)("6a2f6dac",content,!0,{sourceMap:!1})},564:function(t,e,n){var content=n(649);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(25).default)("57692790",content,!0,{sourceMap:!1})},646:function(t,e,n){"use strict";n(563)},647:function(t,e,n){var o=n(24)(!1);o.push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([t.i,".upload-field[data-v-174f0075]{position:relative}.upload-field__wrap[data-v-174f0075]{border:thin dashed #1967d2!important;border-radius:4px;padding:8px;display:flex;align-items:center;cursor:pointer;position:relative;margin-bottom:4px;width:100%;height:240px;background-color:#e8f0fe;overflow:hidden}.upload-field--error[data-v-174f0075]{border:2px solid #ff5252!important}.upload-field__disabled[data-v-174f0075]{position:absolute;top:0;bottom:0;left:0;right:0}.upload-field__details[data-v-174f0075]{margin-bottom:8px;padding:0 12px;display:flex;flex:1 0 auto;max-width:100%;min-height:14px;overflow:hidden}.upload-field__details--hide[data-v-174f0075]{display:none!important}.upload-field--readonly[data-v-174f0075]{cursor:auto}.upload-field__input[data-v-174f0075]{z-index:9;width:100%;opacity:0}.upload-field__img[data-v-174f0075],.upload-field__input[data-v-174f0075]{position:absolute;top:0;left:0;right:0;bottom:0}.upload-field__text[data-v-174f0075]{flex:100%;position:relative;text-align:center}.upload-field--error>.upload-field__text>*>*[data-v-174f0075]{color:#dd2c00}.upload-field__wrap:not(.upload-field--disabled) .upload-field__remove>*[data-v-174f0075]{color:#dd2c00!important}.upload-field__wrap:not(.upload-field--error):not(.upload-field--disabled):hover>.upload-field__text>*>*[data-v-174f0075]{color:#1aa24e}",""]),t.exports=o},648:function(t,e,n){"use strict";n(564)},649:function(t,e,n){var o=n(24)(!1);o.push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([t.i,".bbox__container[data-v-219c58bd]{display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.04)}",""]),t.exports=o},656:function(t,e){},657:function(t,e){},665:function(t,e){},705:function(t,e){},706:function(t,e){},707:function(t,e){},708:function(t,e,n){var content=n(780);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(25).default)("25822837",content,!0,{sourceMap:!1})},717:function(t,e,n){"use strict";n.r(e);n(47),n(5),n(33),n(61),n(48),n(26),n(9),n(62),n(66),n(50);var o=n(21),l=n(709),r=n.n(l);function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,d=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){d=!0,l=t},f:function(){try{r||null==n.return||n.return()}finally{if(d)throw l}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var f={name:"UploadImageField",extends:n(517).a,inject:{form:{default:null}},props:{value:{type:String,default:""},src:{type:String,default:""},addText:{type:String,default:"เพิ่มภาพ"},removeText:{type:String,default:"นำออก"},accept:{type:String,default:"image/png,image/jpg"}},data:function(){return{url:"",localValue:"",originalFile:null}},watch:{value:function(t){this.localValue=t},src:function(t){this.url=t}},mounted:function(){this.valid=!0,this.url=this.src,this.localValue=this.value},created:function(){this.form&&this.form.register(this)},beforeDestroy:function(){this.form&&this.form.unregister(this)},methods:{validate:function(t,e){if(t){var n=[];e=e||this.localValue,t&&(this.hasInput=this.hasFocused=!0);var l,r=d(this.rules);try{for(r.s();!(l=r.n()).done;){var c=l.value,f="function"==typeof c?c(e):c;"string"==typeof f?n.push(f):"boolean"!=typeof f&&console.error("Rules should return a string or boolean, received '".concat(Object(o.a)(f),"' instead"),this)}}catch(t){r.e(t)}finally{r.f()}return this.errorBucket=n,this.valid=0===n.length,this.valid}},reset:function(){this.valid=!0,this.url="",this.localValue="",this.originalFile=null,this.errorBucket=[],this.$emit("input",this.localValue)},resetValidation:function(){this.valid=!0,this.errorBucket=[]},getOriginalFile:function(){return this.originalFile},onRemove:function(){this.disabled||(this.url="",this.localValue="",this.originalFile=null,this.$emit("input",this.localValue),this.validate(!0,this.localValue))},onSelectImage:function(){this.disabled||this.$refs.picture_upload.click()},onChangeImage:function(){var t=this,input=this.$refs.picture_upload.files;if(input&&input[0])new r.a(input[0],{convertSize:5e6,maxWidth:1040,success:function(e){var n=new FileReader;n.onload=function(n){t.localValue=n.target.result,t.$emit("input",t.localValue),t.$emit("change",t.localValue,e),t.$refs.picture_upload.value=null,t.$refs.picture_upload.type="text",t.$refs.picture_upload.type="file",t.validate(!0,t.localValue)},n.readAsDataURL(e),t.originalFile=e}})},onToggleAction:function(){this.readOnly||this.disabled||this.onSelectImage()}}},h=(n(646),n(65)),v=n(79),m=n.n(v),_=n(197),x=n(169),y=n(505),component=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-field"},[n("div",{class:["upload-field__wrap",{"upload-field--error":!t.valid,"upload-field--disabled":t.disabled}],on:{click:t.onToggleAction}},[n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"picture_upload",staticClass:"upload-field__input",attrs:{type:"file",alt:"",title:"",accept:t.accept},on:{input:t.onChangeImage}}),t._v(" "),t.localValue?n("div",{staticClass:"upload-field__img"},[n("v-img",{staticClass:"grey lighten-4",attrs:{src:t.localValue,width:"100%",height:"100%",contain:""}})],1):t.src?n("div",[n("v-img",{staticClass:"grey lighten-4",attrs:{src:t.url,width:"100%",height:"100%",contain:""}})],1):n("div",{class:["upload-field__text"]},[n("div",{staticClass:"mx-auto mt-4"},[n("v-icon",{attrs:{color:"#1967d2",size:"18",left:""}},[t._v("mdi-tray-arrow-up")]),t._v(" "),n("span",{staticClass:"text-body-2",staticStyle:{color:"#1967d2"}},[t._v(t._s(t.addText))])],1)])]),t._v(" "),n("div",{class:["upload-field__details",{"upload-field__details--hide":t.hideDetails}]},[t.errorBucket.length<1&&t.hint&&(t.persistentHint||t.isFocused)?n("VMessages",{attrs:{value:[t.hint]}}):t._e(),t._v(" "),n("VMessages",{attrs:{value:t.errorBucket,color:"error"}})],1)])}),[],!1,null,"174f0075",null);e.default=component.exports;m()(component,{VIcon:_.a,VImg:x.a,VMessages:y.a})},718:function(t,e,n){"use strict";n.r(e);n(28);var o={name:"BoundingBoxCanvas",props:{width:{type:Number,default:100},height:{type:Number,default:100},src:{type:String,default:null}},data:function(){return{stageConfig:{width:100,height:100,scaleX:.5,scaleY:.5},imageConfig:{image:null,width:100,height:100,x:0,y:0}}},watch:{src:function(t){this.loadImage(t)}},mounted:function(){this.loadImage(this.src)},methods:{loadImage:function(t){var e=this;if(t){var image=new Image;image.onload=function(){var t=Math.min(e.width/image.width,e.height/image.height),n=e.calculateAspectRatioFit(image.width,image.height,e.width,e.height);e.stageConfig.width=n.width,e.stageConfig.height=n.height,e.stageConfig.scaleX=1*t,e.stageConfig.scaleY=1*t,e.imageConfig.image=image,e.imageConfig.width=image.width,e.imageConfig.height=image.height},image.src=t}},calculateAspectRatioFit:function(t,e,n,o){var l=Math.min(n/t,o/e);return{width:t*l,height:e*l}}}},l=(n(648),n(65)),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bbox__container",style:{width:t.width+"px",height:t.height+"px"}},[n("v-stage",{ref:"stage",staticClass:"bbox__stage",attrs:{config:t.stageConfig}},[n("v-layer",{ref:"layer"},[n("v-image",{attrs:{config:t.imageConfig}})],1)],1)],1)}),[],!1,null,"219c58bd",null);e.default=component.exports},779:function(t,e,n){"use strict";n(708)},780:function(t,e,n){var o=n(24)(!1);o.push([t.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),o.push([t.i,".ad-detection-page[data-v-0d4ee5e1]{padding:8px;display:flex;align-items:center;justify-content:center}.ad-detection-database[data-v-0d4ee5e1]{padding-top:8px;display:flex}.ad-detection-database-list[data-v-0d4ee5e1]{overflow:hidden;overflow-x:auto;margin-left:8px;display:flex}.ad-detection-database-item[data-v-0d4ee5e1]{width:58px;height:58px}.ad-detection-database-list>.ad-detection-database-item+.ad-detection-database-item[data-v-0d4ee5e1]{margin-left:4px}.ad-detection-workspace[data-v-0d4ee5e1]{display:flex}.ad-detection__container[data-v-0d4ee5e1]{max-width:800px;width:100%;margin:auto}.ad-detection-upload-btn[data-v-0d4ee5e1]{width:72px;height:58px;padding:4px 8px;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:#e8f0fe;border-radius:4px;cursor:pointer;position:relative}.ad-detection-upload-btn>input[data-v-0d4ee5e1]{display:none}.ad-detection-upload-btn>.ad-detection-upload-btn__text[data-v-0d4ee5e1],.ad-detection-upload-btn>i[data-v-0d4ee5e1]{color:#1967d2}.ad-detection-upload-btn>.ad-detection-upload-btn__text[data-v-0d4ee5e1]{font-size:.8rem}.ad-detection-upload-btn[data-v-0d4ee5e1]:hover{background-color:#d2e3fc}",""]),t.exports=o},827:function(t,e,n){"use strict";n.r(e);n(5),n(93);var o=n(27),l=n(51),r=n(44),d=n(31),c=n(37),f=n(36),h=(n(26),n(78),n(90),n(716));function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Object(d.a)(t);if(e){var l=Object(d.a)(this).constructor;n=Reflect.construct(o,arguments,l)}else n=o.apply(this,arguments);return Object(r.a)(this,n)}}var m=Object(c.a)((function t(e){return Object(f.a)(this,t),h.f.l1l2(e)}));m.className="L2",h.i.registerClass(m);var _=function(t){Object(l.a)(n,t);var e=v(n);function n(){return Object(f.a)(this,n),e.call(this,{})}return Object(c.a)(n,null,[{key:"className",get:function(){return"Lambda"}}]),n}(h.c.Layer);h.i.registerClass(_);var x={name:"AdDetectionPage",layout:"ml",data:function(){return{title:"Ad Detection",databases:[],uploadDatabaseDialog:!1,createDatabaseValid:!0,createDatabase:{label:"",img:""},initializing:!1,databaseUpdating:!1,isPreviewUploaded:!1,embeddingModel:null,canvasWidth:100,canvasHeight:100,testImg:null,testOriginalSize:{w:0,h:0},testResize:{w:0,h:0}}},head:function(){return{title:this.title}},watch:{uploadDatabaseDialog:function(t){var e=this;this.$nextTick((function(){e.$refs.database_form.reset()}))}},mounted:function(){this.initialize()},methods:{initialize:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.initializing=!0,e.next=4,h.d("/models/detection-offline-ad/model.json");case 4:n=e.sent,console.log(n),t.embeddingModel=n,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:return e.prev=12,t.initializing=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])})))()},onResize:function(){var t=document.querySelector("#workspace");if(t){var e=t.offsetWidth-32;this.canvasWidth=Math.round(.6*e),this.canvasHeight=this.canvasWidth,console.log(e)}},resizeCanvas:function(){var t=document.querySelector("#workspace");t&&console.log(t.offsetWidth)},handleAddDatabase:function(){var t=this;if(this.$refs.database_form.validate())try{this.databaseUpdating=!0,console.log("upload",this.createDatabase);var image=new Image;image.onload=function(){var e=h.b.fromPixels(image).resizeNearestNeighbor([224,224]).toFloat().div(h.g(255)).expandDims(),n=t.embeddingModel.predict(e);t.databases.push({id:Date.now(),img:t.createDatabase.img,label:t.createDatabase.label,embedded:n.arraySync()}),t.uploadDatabaseDialog=!1},image.src=this.createDatabase.img}catch(t){}finally{this.databaseUpdating=!1}},handleOnUploadTest:function(t,e){this.isPreviewUploaded=!0,this.testImg=t,this.findAd(t.split(",")[1])},findAd:function(image){console.log(image)}}},y=(n(779),n(65)),w=n(79),C=n.n(w),D=n(292),k=n(710),V=n(598),I=n(825),j=n(823),S=n(824),A=n(197),O=n(169),z=n(458),R=n(831),$=n(794),F=n.n($),M=n(215),component=Object(y.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],staticClass:"ad-detection-page fill-height"},[n("div",{staticClass:"ad-detection__container"},[n("v-card",[n("v-card-title",{staticClass:"py-2"},[n("div",[t._v("Artwork")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:""}},[n("v-icon",[t._v("mdi-dots-vertical")])],1)],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",[t.databases.length>0?n("div",[t._v(t._s(t.databases.length)+" Image samples")]):n("div",[t._v("Add Image samples:")]),t._v(" "),n("div",{staticClass:"ad-detection-database"},[n("div",{staticClass:"ad-detection-upload-btn",on:{click:function(e){t.uploadDatabaseDialog=!0}}},[n("v-icon",{attrs:{size:"18"}},[t._v("mdi-tray-arrow-up")]),t._v(" "),n("div",{staticClass:"ad-detection-upload-btn__text"},[t._v("Upload")])],1),t._v(" "),n("div",{staticClass:"ad-detection-database-list"},[t._l(t.databases,(function(t){return[n("div",{key:t.id,staticClass:"ad-detection-database-item"},[n("v-img",{attrs:{src:t.img,width:"100%",contain:""}})],1)]}))],2)])])],1),t._v(" "),n("v-card",{staticClass:"mt-8",attrs:{id:"workspace"}},[n("v-card-title",[t._v("Preview")]),t._v(" "),n("v-divider"),t._v(" "),t.databases.length>0&&!t.isPreviewUploaded?n("v-card-text",[n("upload-image-field",{ref:"upload_test",staticStyle:{width:"100%"},attrs:{"add-text":"Click to upload",accept:"image/jpeg","hide-details":""},on:{change:t.handleOnUploadTest},model:{value:t.testImg,callback:function(e){t.testImg=e},expression:"testImg"}})],1):t.isPreviewUploaded?n("v-card-text",[n("div",{staticClass:"ad-detection-workspace"},[n("div",{staticClass:"ad-detection-workspace__canvas"},[n("bounding-box-canvas",{attrs:{src:t.testImg,width:t.canvasWidth,height:t.canvasHeight}})],1),t._v(" "),n("div",{staticClass:"ad-detection-workspace__output"})])]):n("v-card-text",[t._v("\n        You must add artwork on top panel before you can preview it here\n      ")])],1)],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"480",persistent:""},model:{value:t.uploadDatabaseDialog,callback:function(e){t.uploadDatabaseDialog=e},expression:"uploadDatabaseDialog"}},[n("v-card",[n("v-card-title",[t._v("Add new artwork")]),t._v(" "),n("v-card-text",[n("v-form",{ref:"database_form",on:{submit:function(t){t.preventDefault()}},model:{value:t.createDatabaseValid,callback:function(e){t.createDatabaseValid=e},expression:"createDatabaseValid"}},[n("v-text-field",{attrs:{label:"Label",rules:[function(t){return!!t||"Enter label name"}],dense:"",outlined:""},model:{value:t.createDatabase.label,callback:function(e){t.$set(t.createDatabase,"label",e)},expression:"createDatabase.label"}}),t._v(" "),n("upload-image-field",{ref:"upload_database",staticStyle:{width:"100%"},attrs:{rules:[function(t){return!!t||"Enter image"}],"add-text":"Click to upload",accept:"image/jpeg"},model:{value:t.createDatabase.img,callback:function(e){t.$set(t.createDatabase,"img",e)},expression:"createDatabase.img"}})],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:""},on:{click:function(e){t.uploadDatabaseDialog=!1}}},[t._v("cancel")]),t._v(" "),n("v-btn",{attrs:{color:"primary",text:""},on:{click:t.handleAddDatabase}},[t._v("add")])],1)],1)],1)],1)}),[],!1,null,"0d4ee5e1",null);e.default=component.exports;C()(component,{UploadImageField:n(717).default,BoundingBoxCanvas:n(718).default}),C()(component,{VBtn:D.a,VCard:k.a,VCardActions:V.a,VCardText:V.b,VCardTitle:V.c,VDialog:I.a,VDivider:j.a,VForm:S.a,VIcon:A.a,VImg:O.a,VSpacer:z.a,VTextField:R.a}),F()(component,{Resize:M.a})}}]);